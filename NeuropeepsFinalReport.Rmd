---
title: 'Not Always A Matter Of Context: Preliminary data summaries'
author: "Nicole LaGrange, Tania Delgado, Pamela Riviere"
date: '2017-12-14'
output:
  html_document: default
  pdf_document: default
---

####### __Paper.__ Buechner and Maier (2016) Not always a matter of context: direct effects of red on arousal but context-dependent moderations on valence. _PeerJ_

####### __Summary.__ This study aimed to determine whether colors intrinsically elicit different degrees of physiological arousal, or whether their perceptual effects are dictated by the contextual circumstances in which the colors are experienced. To investigate this question, Buechner and Maier (2016) sorted subjects into one of ___four experimental categories___. These categories consisted of assessing the arousal and valence properties of either:

* four "test-relevant" pictures framed in red
* four "test-relevant" pictures framed in blue
* four "neutral" pictures framed in red
* four "neutral" pictures framed in blue

To assess arousal, participants in each category were asked: "Describe how physiologically arousing do you think [the situation in this picture] is". To assess valence, participants in each category were asked: "Describe how unpleasant do you think [the situation in this picture] is". In response to each question, participants assigned each picture a number from 1 (not at all) to 9 (extremely). 


######## The dataframe contains rows of subjects with their corresponding assessement of a given picture as physically arousing or unpleasant (a measure of valence).


```{r, warning=FALSE, message=FALSE}
library(foreign)
library(dplyr)
library(tidyverse)
library(DescTools)

color_data_pr = read.csv("color_data_pr.csv")
```

### Replicating Analyses and Figures

######### TODO: Remember to 
* include commentary as to why it's potentially weird to collapse across judgments for different pictures

```{r}
# Figure 1 recreated 
ggplot(color_data_pr, aes(x=color, Pic_arousal_MEAN)) +
  geom_bar(stat="summary", fun.y="mean", position="dodge") + 
  stat_summary(fun.y = function(x){mean(x)},
               fun.ymin = function(x){mean(x) - 2*sd(x)/sqrt(length(x))},
               fun.ymax = function(x){mean(x) + 2*sd(x)/sqrt(length(x))},
               geom= 'pointrange') +
  labs(title = 'Figure 1: Mean Arousal Rating for Blue v. Red Pictures', y = 'Mean Picture Arousal Rating', x = 'Picture Color') + theme_minimal()

# ANOVA with color and context as between subjects factors for arousal ratings.
# no significant interaction bewtween color and context on arousal ratings.
# for color
(interact.aro.color = summary(aov(data= color_data_pr, Pic_arousal_MEAN ~ pic * color)))

# for context
(interact.aro.pic = summary(aov(data= color_data_pr, Pic_arousal_MEAN ~ color * pic)))

```
A __very__ subtle effect of __color__ on mean arousal ratings. F(1,301) = 4.34, p = 0.038 results.  
There was also an effect of __context__ on mean arousal ratings. F(1,301) = 115.01, p < .001.

```{r}
# Figure 2 recreated

ggplot(color_data_pr, aes(x=Condition, Pic_valence_MEAN)) +
  geom_bar(stat='summary', fun.y='mean') +
  stat_summary(fun.y = function(x){mean(x)},
               fun.ymin = function(x){mean(x) - 2*sd(x)/sqrt(length(x))},
               fun.ymax = function(x){mean(x) + 2*sd(x)/sqrt(length(x))},
               geom= 'pointrange') +
  labs(title = 'Figure 1: Mean Picture Valence Across Conditions', y = "Mean Picture Valence Rating", x = "Condition") +
  theme_minimal()

# Recreated version: 
ggplot(color_data_pr, aes(x=pic, Pic_arousal_MEAN, fill=color)) +
  geom_bar(stat="summary", fun.y="mean", position="dodge") + 
  stat_summary(fun.y = function(x){mean(x)},
               fun.ymin = function(x){mean(x) - 2*sd(x)/sqrt(length(x))},
               fun.ymax = function(x){mean(x) + 2*sd(x)/sqrt(length(x))},
               geom= 'pointrange', position = position_dodge(0.95)) +
  labs(x = "Condition", y = "Mean Picture Valence Rating", title = 'Mean Picture Valence Across Conditions') +
  theme_minimal()

# ANOVA with color and ocntest as between-subjects factors conducted on valence.
# for color
interact.val.color = aov(data= color_data_pr, Pic_valence_MEAN ~ pic * color)
summary(interact.val.color)

# for context
(interact.val.pic = summary(aov(data= color_data_pr, Pic_valence_MEAN ~ color * pic)))
```

Test-relevant pics generally rated higher in valence (not rated as unpleasant) than neutral pictures (main effect of __context__: F(1,301) = 323.59, p < 0.001). And red pictures generally rated higher in valence than blue pictures (main effect of __color__: F(1,301) = 5.345, p = 0.02). The main effects were modulated by a significant two-way interaction between color and context (interaction: (F(1,301) = 4.12, p = 0.043))

Note, the F-statistic for main effect of __context__ (F(1,301) = 323.59, p < 0.001).  slightly differs from the reported one (F(1,301) = 325.48, p < 0.001).

Note, the F-statistic for main effect of __color__ (F(1,301) = 5.345, p = 0.02) slightly differs from the reported one (F(1,301) = 5.40, p = 0.02).


```{r}


ggplot(color_data_pr, aes(x=Condition, Pic_arousal_MEAN)) +
  geom_bar(stat="summary", fun.y="mean", position="dodge") + 
  labs(title = 'Mean Picture Arousal Across Conditions') + 
  theme_minimal()



ggplot(color_data_pr, aes(x=Condition, Pic_arousal_MEAN)) +
  geom_bar(stat="summary", fun.y="mean", position="dodge") +
  stat_summary(fun.y = function(x){mean(x)},
               fun.ymin = function(x){mean(x) - 2*sd(x)/sqrt(length(x))},
               fun.ymax = function(x){mean(x) + 2*sd(x)/sqrt(length(x))},
               geom= 'pointrange') +
  labs(x = "Condition", y = "Mean Picture Arousal Rating", title = 'Mean Picture Arousal Across Conditions') + 
  theme_minimal()

ggplot(color_data_pr, aes(x=pic, Pic_arousal_MEAN, fill=color)) +
  geom_bar(stat="summary", fun.y="mean", position="dodge", width = 0.5) + 
  stat_summary(fun.y = function(x){mean(x)},
               fun.ymin = function(x){mean(x) - 2*sd(x)/sqrt(length(x))},
               fun.ymax = function(x){mean(x) + 2*sd(x)/sqrt(length(x))},
               geom= 'pointrange', position = position_dodge(0.5)) +
  labs(title = 'Mean Arousal Rating for Neutral v. Test Pictures', y = 'Mean Picture Arousal Rating', x = 'Picture Type') + 
  theme_minimal()




```

```{r}
ggplot(data= color_data_pr, aes(x=color, y= Pic_arousal_MEAN)) + 
  geom_bar(stat="summary", fun.y="mean", position="dodge") +
  stat_summary(fun.y = function(x){mean(x)},
               fun.ymin = function(x){mean(x) - 2*sd(x)/sqrt(length(x))},
               fun.ymax = function(x){mean(x) + 2*sd(x)/sqrt(length(x))},
               geom= 'pointrange') +
  labs(title = 'Mean Arousal Rating for Blue v. Red Pictures', y = 'Mean Picture Arousal Rating', x = 'Picture Color') + theme_minimal()

summary(aov(data = color_data_pr, Pic_arousal_MEAN ~ color))
```
  
```{r}
### Beyond the paper
########## TODO: Run ANCOVA, using trait and test anxiety as the controls, figures we chose to improve, why are they improvements (violin plots here and why they are a nicer representation of the distribution)

### Violin Plot for Arousal Mean
ggplot(color_data_pr, aes(x=pic, Pic_arousal_MEAN, fill=color)) + geom_violin() +   labs(title = 'Mean Arousal Rating for Blue v. Red Pictures', y = 'Mean Picture Arousal Rating', x = 'Picture Type') + theme_minimal()

### Violin Plot for Valence Mean
ggplot(color_data_pr, aes(x=pic, Pic_valence_MEAN, fill=color)) + geom_violin() +   labs(title = 'Mean Valence Rating for Blue v. Red Pictures', y = 'Mean Picture Valence Rating', x = 'Picture Type') + theme_minimal()

# bar or violin plots for the distribution of arousal and valence judgements for each picture
arousal_by_pic = c(mean(color_data_pr$pic1_arousal), 
                   mean(color_data_pr$pic2_arousal), 
                   mean(color_data_pr$pic3_arousal), 
                   mean(color_data_pr$pic4_arousal))

valence_by_pic = c(mean(color_data_pr$pic1_valence), mean(color_data_pr$pic2_valence), mean(color_data_pr$pic3_valence), mean(color_data_pr$pic4_valence))

pics = c('pic1', 'pic2', 'pic3', 'pic4','pic1', 'pic2', 'pic3', 'pic4')
new.df = data.frame(arousal_by_pic, valence_by_pic, pics)

labels = c('arousal', 'arousal', 'arousal', 'arousal',
           'valence', 'valence', 'valence', 'valence')


ratings = c(arousal_by_pic, valence_by_pic)
new.df2 = data.frame(ratings, pics, labels)

arousal.across.pics <- ggplot(new.df2, aes(x=pics, ratings, fill=labels)) +
  geom_bar(stat="identity", position="dodge") + 
  labs(title = 'Mean Picture Arousal Across Pictures') + 
  theme_minimal()
arousal.across.pics

# try this for the error bars
stat_summary (fun.y = function(x){mean(x)},
                fun.ymin = function(x){mean(x) - 2*sd(x)/sqrt(length(x))},
                fun.ymax = function(x){mean(x) + 2*sd(x)/sqrt(length(x))},
                geom= 'pointrange')
```

__some ANOVAs.__ 
``` {r some anovas}

# Let's look at main and interaction effects
interact.val = anova(lm(data = color_data_pr, Pic_valence_MEAN ~ color*pic))
interact.aro = anova(lm(data = color_data_pr, Pic_arousal_MEAN ~ color*pic))


#is this a valid way to go about this? - tania
anova.val.cond = anova(lm(data = color_data_pr, Pic_valence_MEAN ~ Condition))
anova.aro.cond = anova(lm(data = color_data_pr, Pic_arousal_MEAN ~ Condition))

interact.val.cond = anova(lm(data = color_data_pr, Pic_valence_MEAN ~ Condition*Pic_arousal_MEAN))
interact.aro.cond = anova(lm(data = color_data_pr, Pic_arousal_MEAN ~ Condition*Pic_valence_MEAN))
```

__Sheffe__
```{r, Sheffe}

#recreate their scheffe
schef <- PostHocTest(x=interact.val.color, method="scheffe")

```

__some ANCOVAs.__
``` {r some ancovas}

#is this the right way to go about this? - tania

# ANCOVA with valence rating as the response variable, trait or test anxiety as controls
ancova.val.trait_anxiety = anova(lm(data = color_data_pr, Pic_valence_MEAN ~ STAI_MEAN + Condition))
ancova.val.test_anxiety = anova(lm(data = color_data_pr, Pic_valence_MEAN ~ AEQanxiety_MEAN + Condition))

# ANCOVA with arousal rating as the response variable, trait or test anxiety as controls
ancova.aro.trait_anxiety = anova(lm(data = color_data_pr, Pic_arousal_MEAN ~ STAI_MEAN + Condition))
ancova.aro.test_anxiety = anova(lm(data = color_data_pr, Pic_arousal_MEAN ~ AEQanxiety_MEAN + Condition))

```

```{r}






# There is an interaction between Condition and Anxiety

anxiety.interaction <- color_data_pr %>% 
  ggplot() +
  aes(x = AEQanxiety_MEAN, color = Condition, group = Condition, y = Pic_arousal_MEAN) +
  stat_summary(fun.y = mean, geom = "point") +
  stat_summary(fun.y = mean, geom = "line")+ ggtitle('Condition and Anxiety Interaction')

anxiety.interaction


```


